<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lec 1 Fintech and Artificial Intelligence - Interactive Learning</title>
    
    <!-- KaTeX for formula rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    
    <!-- Mermaid for flowcharts and diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.1/dist/mermaid.min.js"></script>
    
    <!-- Fonts: Noto Serif for body, Inter for headings -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        
        :root {
            /* Warm Academic Theme - Clean & Readable */
            --bg-primary: #1a1a2e;
            --bg-secondary: #16213e;
            --bg-tertiary: #1f2b47;
            --bg-elevated: #263352;
            --bg-card: #1c2a45;
            
            --text-primary: #edf2f7;
            --text-secondary: #a0aec0;
            --text-tertiary: #718096;
            
            /* Warm Gold + Sage Green palette */
            --accent-primary: #f6c177;
            --accent-secondary: #a3d9a5;
            --accent-tertiary: #c4b5fd;
            --accent-warning: #fbbf24;
            --accent-error: #fb7185;
            --accent-info: #7dd3fc;
            
            --gradient-primary: linear-gradient(135deg, #f6c177 0%, #e8a87c 100%);
            --gradient-heading: linear-gradient(135deg, #f6c177 0%, #c4b5fd 100%);
            
            --border-color: rgba(255, 255, 255, 0.06);
            --border-hover: rgba(246, 193, 119, 0.25);
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.25);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);
            
            --font-body: 'Georgia', 'Times New Roman', 'Noto Serif SC', serif;
            --font-heading: -apple-system, 'Helvetica Neue', 'PingFang SC', sans-serif;
            --font-mono: 'SF Mono', 'Menlo', 'Monaco', monospace;
            
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            
            --ease: cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @media (prefers-color-scheme: light) {
            :root {
                --bg-primary: #faf8f5;
                --bg-secondary: #f0ece4;
                --bg-tertiary: #e8e2d8;
                --bg-elevated: #ffffff;
                --bg-card: #ffffff;
                
                --text-primary: #1c1917;
                --text-secondary: #57534e;
                --text-tertiary: #a8a29e;
                
                --accent-primary: #c2742f;
                --accent-secondary: #3d8b40;
                --accent-tertiary: #7c3aed;
                --accent-warning: #b45309;
                --accent-error: #dc2626;
                
                --gradient-heading: linear-gradient(135deg, #c2742f 0%, #7c3aed 100%);
                
                --border-color: rgba(0, 0, 0, 0.06);
                --border-hover: rgba(194, 116, 47, 0.3);
                --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.06);
                --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
                --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            }
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        body {
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.8;
            overflow-x: hidden;
        }
        
        .page-container {
            --left-width: 260px;
            --right-width: 300px;
            display: grid;
            grid-template-columns: minmax(200px, var(--left-width)) 8px minmax(0, 1fr) 8px minmax(220px, var(--right-width));
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .column-resizer {
            cursor: col-resize;
            background: transparent;
            transition: background-color 0.15s var(--ease);
            position: sticky;
            top: 0;
            height: 100vh;
            z-index: 5;
        }
        .column-resizer:hover,
        .column-resizer.dragging {
            background: rgba(246, 193, 119, 0.2);
        }
        
        .sidebar-left, .sidebar-right {
            background: var(--bg-secondary);
            padding: 2rem 1.25rem;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-left {
            border-right: 1px solid var(--border-color);
        }
        
        .sidebar-right {
            border-left: 1px solid var(--border-color);
        }
        
        .main-content {
            max-width: none;
            min-width: 0;
            width: 100%;
            margin: 0 auto;
            padding: 3rem 2.5rem;
        }
        
        @media (max-width: 1200px) {
            .page-container { grid-template-columns: 1fr; }
            .sidebar-left, .sidebar-right, .column-resizer { display: none; }
            .main-content { padding: 2rem 1.25rem; }
        }
        
        h1 {
            font-family: var(--font-heading);
            font-size: clamp(1.875rem, 4vw, 2.5rem);
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 0.75rem;
            letter-spacing: -0.01em;
            color: var(--text-primary);
        }
        
        h2 {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 3.5rem;
            margin-bottom: 1.25rem;
            color: var(--accent-primary);
            letter-spacing: -0.01em;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        h3 {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }
        
        h4 {
            font-family: var(--font-heading);
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--accent-primary);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        
        h5 {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        p {
            margin-bottom: 1rem;
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.8;
        }
        
        .feynman-block {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-left: 3px solid var(--accent-primary);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin: 1.5rem 0;
            transition: border-color 0.2s var(--ease);
        }
        
        .feynman-block:hover {
            border-color: var(--border-hover);
        }
        
        .feynman-block .icon {
            font-size: 1.75rem;
            margin-bottom: 0.75rem;
            display: inline-block;
        }
        
        .expandable {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            margin: 1.5rem 0;
            overflow: hidden;
        }
        
        .expandable-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            cursor: pointer;
            user-select: none;
            font-weight: 500;
            font-family: var(--font-heading);
            transition: background 0.15s var(--ease);
        }
        
        .expandable-header:hover {
            background: var(--bg-tertiary);
        }
        
        .expandable-icon {
            transition: transform 0.25s var(--ease);
            display: inline-block;
            font-size: 0.8rem;
        }
        
        .expandable.open .expandable-icon {
            transform: rotate(180deg);
        }
        
        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s var(--ease);
        }
        
        .expandable.open .expandable-content {
            max-height: 5000px;
        }
        
        .expandable-content-inner {
            padding: 1.25rem;
            border-top: 1px solid var(--border-color);
        }
        
        .quiz-container {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
        }
        
        .quiz-question {
            font-size: 1.05rem;
            font-family: var(--font-heading);
            margin-bottom: 1.25rem;
            color: var(--text-primary);
        }
        
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.625rem;
        }
        
        .quiz-option {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: all 0.15s var(--ease);
            font-size: 0.95rem;
        }
        
        .quiz-option:hover {
            border-color: var(--accent-primary);
            padding-left: 1.25rem;
        }
        
        .quiz-option.correct {
            background: rgba(163, 217, 165, 0.2);
            border-color: var(--accent-secondary);
            color: var(--accent-secondary);
        }
        
        .quiz-option.incorrect {
            background: rgba(251, 113, 133, 0.15);
            border-color: var(--accent-error);
            color: var(--accent-error);
        }
        
        .quiz-feedback {
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            border-radius: var(--radius-sm);
            display: none;
            font-size: 0.9rem;
        }
        
        .quiz-feedback.show { display: block; }
        .quiz-feedback.correct { background: rgba(163, 217, 165, 0.15); border: 1px solid var(--accent-secondary); }
        .quiz-feedback.incorrect { background: rgba(251, 113, 133, 0.1); border: 1px solid var(--accent-error); }
        
        .progress-tracker {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--bg-secondary);
            z-index: 1000;
        }
        
        .progress-bar {
            height: 100%;
            background: var(--gradient-primary);
            width: 0%;
            transition: width 0.2s var(--ease);
        }
        
        .ai-chat {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            padding: 1.25rem;
        }
        
        .ai-chat-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .ai-chat-messages {
            max-height: 320px;
            overflow-y: auto;
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
        }
        
        .ai-message {
            margin-bottom: 0.75rem;
            padding: 0.625rem 0.875rem;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            line-height: 1.6;
        }
        
        .ai-message.user {
            background: var(--accent-primary);
            color: var(--bg-primary);
            margin-left: 1.5rem;
            font-weight: 500;
        }
        
        .ai-message.assistant {
            background: var(--bg-tertiary);
            margin-right: 1.5rem;
        }
        
        .ai-input-group { display: flex; gap: 0.5rem; }
        
        .ai-input {
            flex: 1;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 0.625rem 0.75rem;
            color: var(--text-primary);
            font-family: var(--font-body);
            font-size: 0.875rem;
        }
        
        .ai-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }
        
        .ai-send-btn, .action-btn {
            background: var(--accent-primary);
            color: var(--bg-primary);
            border: none;
            border-radius: var(--radius-sm);
            padding: 0.625rem 1rem;
            cursor: pointer;
            font-weight: 600;
            font-family: var(--font-heading);
            font-size: 0.85rem;
            transition: opacity 0.15s;
        }
        
        .action-btn {
            width: 100%;
            margin-bottom: 0.5rem;
            text-align: left;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }
        
        .ai-send-btn:hover { opacity: 0.85; }
        .action-btn:hover { border-color: var(--accent-primary); color: var(--accent-primary); }
        
        kbd {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 0.15rem 0.5rem;
            font-family: var(--font-mono);
            font-size: 0.8em;
        }
        
        .toc-link {
            color: var(--text-secondary);
            text-decoration: none;
            display: block;
            padding: 0.375rem 0.5rem;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            font-family: var(--font-heading);
            transition: color 0.15s, background 0.15s;
        }
        
        .toc-link:hover {
            color: var(--accent-primary);
            background: var(--bg-tertiary);
        }
        
        /* Scroll reveal - simple fade */
        .reveal-on-scroll {
            opacity: 0;
            transform: translateY(16px);
            transition: opacity 0.5s var(--ease), transform 0.5s var(--ease);
        }
        .reveal-on-scroll.revealed {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--bg-elevated); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-tertiary); }
        
        ::selection { background: var(--accent-primary); color: var(--bg-primary); }
        
        /* Print */
        @media print {
            .sidebar-left, .sidebar-right, .progress-tracker { display: none; }
            .page-container { grid-template-columns: 1fr; }
            body { background: white; color: black; }
        }
        
        /* ===========================================
           DATA VISUALIZATION & CHARTS
           =========================================== */
        .chart-container {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
        }
        .chart-container .chart-title {
            font-family: var(--font-heading);
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            text-align: center;
        }
        .chart-container canvas { max-height: 380px; width: 100% !important; }
        .chart-caption {
            font-size: 0.85rem;
            color: var(--text-tertiary);
            text-align: center;
            margin-top: 0.75rem;
            font-style: italic;
        }
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .chart-grid .chart-container { margin: 0; }
        
        .diagram-container {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            margin: 2rem 0;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            overflow-x: auto;
            text-align: center;
        }
        .diagram-container .diagram-title {
            font-family: var(--font-heading);
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }
        .diagram-container .mermaid { display: flex; justify-content: center; }
        .diagram-container .mermaid svg { max-width: 100%; height: auto; }
        .diagram-caption {
            font-size: 0.85rem;
            color: var(--text-tertiary);
            text-align: center;
            margin-top: 0.75rem;
            font-style: italic;
        }
        
        .comparison-block {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 1rem;
            align-items: stretch;
            margin: 2rem 0;
        }
        .comparison-side {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
        }
        .comparison-side.left { border-top: 3px solid var(--accent-primary); }
        .comparison-side.right { border-top: 3px solid var(--accent-secondary); }
        .comparison-side h4 { margin-bottom: 0.75rem; }
        .comparison-side ul { padding-left: 1.25rem; }
        .comparison-side li { margin-bottom: 0.5rem; color: var(--text-secondary); font-size: 0.95rem; }
        .comparison-divider {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            color: var(--text-tertiary);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        .stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 1.25rem;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: transform 0.15s var(--ease);
        }
        .stat-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); }
        .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-primary);
            display: block;
            font-family: var(--font-heading);
        }
        .stat-label {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .comparison-block { grid-template-columns: 1fr; }
            .comparison-divider { justify-content: center; padding: 0.5rem 0; }
            .chart-grid { grid-template-columns: 1fr; }
        }
        
        /* ===========================================
           SIDEBAR TABS & PANELS
           =========================================== */
        .sidebar-tabs {
            display: flex;
            gap: 2px;
            margin-bottom: 1rem;
            background: var(--bg-primary);
            border-radius: var(--radius-sm);
            padding: 2px;
        }
        .sidebar-tab {
            flex: 1;
            padding: 0.5rem 0.25rem;
            background: transparent;
            border: none;
            color: var(--text-tertiary);
            font-family: var(--font-heading);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.15s var(--ease);
        }
        .sidebar-tab:hover { color: var(--text-secondary); }
        .sidebar-tab.active {
            background: var(--bg-elevated);
            color: var(--accent-primary);
        }
        
        /* ===========================================
           NOTES SYSTEM
           =========================================== */
        .note-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            padding: 0.625rem;
            font-size: 0.85rem;
            position: relative;
            cursor: pointer;
            transition: border-color 0.15s var(--ease), transform 0.15s var(--ease);
        }
        .note-card:hover { border-color: var(--border-hover); }
        .note-card.active {
            border-color: var(--accent-primary);
            transform: translateY(-1px);
        }
        .note-card.focused {
            border-left: 3px solid var(--accent-secondary);
            padding-left: calc(0.625rem - 2px);
        }
        .note-card .note-citation {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            border-left: 2px solid var(--accent-primary);
            padding-left: 0.5rem;
            margin-bottom: 0.375rem;
            font-style: italic;
            line-height: 1.4;
        }
        .note-card .note-body {
            color: var(--text-secondary);
            line-height: 1.5;
        }
        .note-card .note-meta {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-top: 0.375rem;
            display: flex;
            justify-content: space-between;
        }
        .note-card .note-delete {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            font-size: 0.75rem;
            padding: 0;
        }
        .note-card .note-delete:hover { color: var(--accent-error); }
        .note-card .note-focus {
            background: none;
            border: none;
            color: var(--accent-secondary);
            cursor: pointer;
            font-size: 0.75rem;
            padding: 0;
            margin-right: 0.5rem;
        }
        .note-card .note-focus:hover { color: var(--accent-primary); }
        .note-reader {
            margin-top: 0.75rem;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-primary);
            overflow-y: auto;
            max-height: 34vh;
        }
        .note-reader .reader-title {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            margin-bottom: 0.5rem;
        }
        .note-reader .reader-content {
            color: var(--text-secondary);
            line-height: 1.65;
            font-size: 0.9rem;
        }
        .note-reader .reader-content code {
            background: var(--bg-tertiary);
            padding: 0.1em 0.35em;
            border-radius: 4px;
            font-size: 0.85em;
        }
        .note-draft-preview {
            margin-top: 0.5rem;
            max-height: 20vh;
        }
        
        /* ===========================================
           TEXT HIGHLIGHT
           =========================================== */
        .text-highlight {
            background: rgba(246, 193, 119, 0.25);
            border-bottom: 2px solid var(--accent-primary);
            cursor: pointer;
            transition: background 0.15s;
        }
        .text-highlight:hover {
            background: rgba(246, 193, 119, 0.4);
        }
        
        /* Highlight context menu */
        .highlight-tooltip {
            position: fixed;
            background: var(--bg-elevated);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-lg);
            padding: 0.25rem;
            display: none;
            z-index: 1001;
            gap: 2px;
        }
        .highlight-tooltip.show { display: flex; }
        .highlight-tooltip button {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 0.375rem 0.625rem;
            cursor: pointer;
            font-size: 0.8rem;
            font-family: var(--font-heading);
            border-radius: 4px;
            white-space: nowrap;
        }
        .highlight-tooltip button:hover {
            background: var(--bg-tertiary);
            color: var(--accent-primary);
        }
    
    </style>
    <link rel="stylesheet" href="./app-shell.css?v=12" />
</head>
<body data-shell-page="lecture">
    <!-- Progress Tracker -->
    <div class="progress-tracker">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="page-container">
        <!-- Left Sidebar -->
        <aside class="sidebar-left">
            <!-- Sidebar Tabs -->
            <div class="sidebar-tabs">
                <button class="sidebar-tab active" data-tab="toc" onclick="switchSidebarTab('toc')">Contents</button>
                <button class="sidebar-tab" data-tab="pdf" onclick="switchSidebarTab('pdf')">PDF</button>
                <button class="sidebar-tab" data-tab="notes" onclick="switchSidebarTab('notes')">Notes</button>
            </div>
            
            <!-- Tab: Table of Contents -->
            <div class="sidebar-panel" id="panel-toc">
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.75rem;">
                        <a href="#overview" class="toc-link">Overview</a>
                    </li>
                    
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-1" class="toc-link">Definition of Fintech</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-2" class="toc-link">Fintech vs. Traditional Finance</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-3" class="toc-link">Core Fintech Business Models</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-4" class="toc-link">Automated Decision Making</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-5" class="toc-link">Fintech Regulation</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-6" class="toc-link">Institutional Integration</a>
            </li>
        
            <li style="margin-bottom: 0.75rem;">
                <a href="#concept-7" class="toc-link">Blockchain and Crowdfunding</a>
            </li>
        
                </ul>
                
                <div style="margin-top: 3rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.85rem;">
                    <div style="color: var(--text-tertiary); margin-bottom: 0.5rem;">Course Stats</div>
                    <div style="color: var(--text-secondary);">
                        <div>7 Concepts</div>
                        <div>2146 Images</div>
                        <div>7 Tables</div>
                    </div>
                </div>
            </div>
            
            <!-- Tab: PDF Viewer -->
            <div class="sidebar-panel" id="panel-pdf" style="display:none;">
                <div id="pdfViewerContainer" style="height: calc(100vh - 80px); display: flex; flex-direction: column;">
                    <p style="font-size: 0.85rem; color: var(--text-tertiary); margin-bottom: 0.75rem;">Source: Lec 1 Fintech and Artificial Intelligence.pdf</p>
                    <iframe id="pdfFrame" src="../pdfs/Lec 1 Fintech and Artificial Intelligence.pdf" style="flex:1; width:100%; border:none; border-radius: var(--radius-sm); background: var(--bg-tertiary);"></iframe>
                </div>
            </div>
            
            <!-- Tab: Notes -->
            <div class="sidebar-panel" id="panel-notes" style="display:none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                    <span style="font-size: 0.85rem; color: var(--text-tertiary);" id="notesCount">0 notes</span>
                    <button onclick="exportNotesToObsidian()" class="action-btn" style="width:auto; padding: 0.4rem 0.75rem; font-size: 0.8rem;">Export .md</button>
                </div>
                <div id="notesList" style="display: flex; flex-direction: column; gap: 0.5rem; max-height: 32vh; overflow-y: auto;"></div>
                <div id="noteReader" class="note-reader">
                    <div class="reader-title">Reading</div>
                    <div class="reader-content">Click a note in history to read it here.</div>
                </div>
                <div style="margin-top: 0.75rem; border-top: 1px solid var(--border-color); padding-top: 0.75rem;">
                    <textarea id="noteInput" oninput="handleNoteInputChange(this.value)" placeholder="Write a note (Markdown supported)..." style="width:100%; min-height: 80px; background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: var(--radius-sm); padding: 0.5rem; color: var(--text-primary); font-family: var(--font-mono); font-size: 0.85rem; resize: vertical;"></textarea>
                    <div id="noteDraftPreview" class="note-reader note-draft-preview">
                        <div class="reader-title">Live Preview</div>
                        <div class="reader-content" id="noteDraftPreviewContent">Type in the note box to preview Markdown rendering in real time.</div>
                    </div>
                    <button onclick="addFreeNote()" class="action-btn" style="margin-top: 0.375rem;">Add Note</button>
                </div>
            </div>
        </aside>

        <div class="column-resizer" id="resizerLeft" role="separator" aria-orientation="vertical" aria-label="Resize left sidebar"></div>

        <!-- Main Content -->
        <main class="main-content">
            <header id="overview">
                <h1>Lec 1 Fintech and Artificial Intelligence</h1>
                <p style="font-size: 1.1rem; color: var(--text-tertiary); margin-bottom: 2rem;">
                    Interactive Learning Experience ‚Ä¢ Source: Lec 1 Fintech and Artificial Intelligence.pdf
                </p>
                
                <!-- Course Overview -->
                <div class="feynman-block" style="border-left-color: #9f7aea;">
                    <h4>Course Overview</h4>
                    <p><strong>Difficulty:</strong> Beginner</p>
                    
                    <h5 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--accent-primary);">Prerequisites:</h5>
                    <ul style="margin-left: 1.5rem;">
                        <li>Basic understanding of banking and financial services</li><li>General awareness of digital technology and the internet</li><li>Introductory knowledge of business management</li>
                    </ul>
                    
                    <h5 style="margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--accent-secondary);">Learning Objectives:</h5>
                    <ul style="margin-left: 1.5rem;">
                        <li>Define Fintech and identify its primary components and characteristics.</li><li>Contrast traditional financial service models with modern technology-driven Fintech models.</li><li>Identify the major business sectors within the Fintech landscape, such as wealth management and mobile payments.</li><li>Discuss the importance of regulation and the relationship between traditional banks and Fintech startups.</li>
                    </ul>
                </div>
            </header>

            <!-- Concept Sections -->
            
        <section id="concept-1" class="concept-section">
            <h2>Definition of Fintech</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Traditional banking is like a physical post office where you must stand in line to send a letter; Fintech is like instant messaging‚Äîit takes the same goal of moving value and makes it instant, digital, and accessible from your pocket.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>Fintech makes financial services accessible to the 'unbanked' population and drastically reduces transaction costs. It forces the entire global economy to become more efficient, transparent, and responsive to individual consumer needs.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="comparison-block">
            <div class="comparison-side left">
                <h4>üîµ Traditional Finance</h4>
                <ul><li>Physical branches and manual paperwork</li><li>Human-led risk assessment (slow)</li><li>High overhead costs and service fees</li><li>Limited access (standard business hours)</li></ul>
            </div>
            <div class="comparison-divider">vs</div>
            <div class="comparison-side right">
                <h4>üü¢ Fintech</h4>
                <ul><li>Mobile-first and cloud-based platforms</li><li>AI and algorithmic decision-making (instant)</li><li>Lower fees due to automation</li><li>24/7 global accessibility</li></ul>
            </div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Fintech represents the fusion of financial services with advanced technologies like Artificial Intelligence, Cloud Computing, and Blockchain to disrupt traditional business models. Rather than relying on physical infrastructure and manual human oversight, Fintech uses data-driven algorithms to automate tasks such as credit scoring, fraud detection, and asset management. This shift moves the industry away from a 'one-size-fits-all' model toward hyper-personalized services that operate in real-time. It is an evolving ecosystem where over 200 academic and industry perspectives agree: the core objective is to improve the delivery and use of financial services through innovation.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>============================================================


## Definition of Fintech


## ‚óè(Combining over 200 academic


## papers/industry reports) Fintech is a


## industry that attempts to use new</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Consider a 'Robo-advisor' platform. Instead of paying a human financial advisor a 1-2% fee to manually pick stocks, an algorithm automatically rebalances your investment portfolio 24/7 based on your risk tolerance and market data. This allows someone with only $500 to receive the same sophisticated investment strategy previously reserved for millionaires.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Students often think Fintech is just 'banking with an app.' In reality, it involves a fundamental shift in the underlying technology and logic, such as using AI to predict market trends or using decentralized ledgers instead of a central bank database.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> How was the provided definition of 'Fintech' synthesized?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        By interviewing a single CEO of a major tech firm
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        By combining over 200 academic papers and industry reports
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        By using a dictionary definition from the early 1900s
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        By analyzing a single government regulatory document
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The content specifies that the definition is a result of combining over 200 academic papers and industry reports to reach a comprehensive understanding.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The content specifies that the definition is a result of combining over 200 academic papers and industry reports to reach a comprehensive understanding.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> Based on the definition provided, what is the primary objective of the Fintech industry?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        To return to traditional paper-based banking methods
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        To discourage the use of technology in finance
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        To use new technologies to improve financial activities
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        To exclusively focus on manufacturing physical hardware
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Fintech is defined as an industry that attempts to leverage new technologies to innovate and improve financial services.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Fintech is defined as an industry that attempts to leverage new technologies to innovate and improve financial services.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> The term 'Fintech' is most accurately described in the text as a(n):
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Academic theory only
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Specific type of software program
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Industry that utilizes new technology
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Government department for regulation
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The text defines Fintech as an industry that focuses on the application of new technology within the financial sector.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The text defines Fintech as an industry that focuses on the application of new technology within the financial sector.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-2" class="concept-section">
            <h2>Fintech vs. Traditional Finance</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Traditional finance is like a classic restaurant where a human waiter takes your order and the chef manually prepares your meal; it is reliable but slow. Fintech is like a smart vending machine or a high-tech kiosk: it uses a pre-programmed system to give you exactly what you want instantly, without needing a person in the middle.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>This shift democratizes access to money, allowing people without traditional credit histories to get loans or invest. It reduces costs for consumers and forces global economies to move at the speed of the internet rather than the speed of paperwork.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="comparison-block">
            <div class="comparison-side left">
                <h4>üîµ Traditional Finance</h4>
                <ul><li>Human-based operations (Bankers/Tellers)</li><li>Physical branches and paperwork</li><li>Strict, established regulatory frameworks</li><li>Decisions based on credit scores and collateral</li></ul>
            </div>
            <div class="comparison-divider">vs</div>
            <div class="comparison-side right">
                <h4>üü¢ Fintech</h4>
                <ul><li>Algorithmic and data-driven automation</li><li>Mobile-first and cloud-based systems</li><li>Evolving and agile regulatory frameworks</li><li>Decisions based on Big Data and AI patterns</li></ul>
            </div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Traditional finance operates on a foundation of 'human-in-the-loop' processes, where physical branches, manual audits, and professional judgment manage risk within long-standing regulatory frameworks. Fintech disrupts this by replacing human gatekeepers with automated algorithms and big data analytics. Instead of relying on a banker's intuition, Fintech uses machine learning to process thousands of data points‚Äîlike transaction history or even social media behavior‚Äîto make instant financial decisions. This results in a system that is significantly more efficient and scalable, though it creates a 'regulatory lag' where laws must constantly evolve to address new digital risks.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>A comparison highlighting the shift from human-based operations and strong regulations to algorithmic, data-driven systems with evolving regulatory frameworks.</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>When applying for a loan, a traditional bank might take two weeks to manually review your paper tax returns and salary slips. A Fintech platform like Ant Group or Affirm can analyze your real-time digital spending patterns and approve a micro-loan of $500 in less than three seconds using an automated risk algorithm.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Students often assume Fintech is just 'online banking' or having a mobile app for a traditional bank. The true difference lies in the backend: Fintech uses data and code to make decisions, whereas traditional banking still relies on human-designed protocols and manual oversight.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> Which of the following best describes the shift in operational models from traditional finance to Fintech?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        A shift from digital automation to human-centered branch banking
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        A shift from manual, human-mediated processes to algorithmic and data-driven systems
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        A shift from decentralized data analysis to centralized paper-based filing
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        A shift from algorithmic trading to strictly physical asset management
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Fintech replaces traditional human-led operations with automated algorithms and big data to increase efficiency and speed.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Fintech replaces traditional human-led operations with automated algorithms and big data to increase efficiency and speed.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> How do regulatory frameworks typically differ between traditional finance and Fintech?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Traditional finance is unregulated, while Fintech is governed by rigid, ancient laws
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Fintech follows static, long-standing rules while traditional finance has no oversight
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Traditional finance operates under established, strict regulations while Fintech faces evolving and often experimental frameworks
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Both sectors are governed by the exact same regulatory bodies and historical rules
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Traditional finance relies on mature, stable regulations, whereas Fintech often operates in a 'grey area' where laws are still being developed to match new technologies.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Traditional finance relies on mature, stable regulations, whereas Fintech often operates in a 'grey area' where laws are still being developed to match new technologies.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> In terms of decision-making, what is a primary characteristic of the Fintech model?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Reliance on face-to-face interviews and personal relationships
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Exclusively using physical ledgers to track financial health
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Heavily relying on real-time data analytics and automated risk assessment
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Prioritizing human intuition over computer-generated metrics
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Fintech focuses on using real-time data and machine learning to make objective, automated decisions rather than relying on subjective human judgment.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Fintech focuses on using real-time data and machine learning to make objective, automated decisions rather than relying on subjective human judgment.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-3" class="concept-section">
            <h2>Core Fintech Business Models</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Think of traditional banking like an old-fashioned department store where everything is slow and expensive; Fintech is like a collection of specialized, high-speed apps on your phone that do one thing perfectly‚Äîlike ordering food, but for your money. It replaces the slow human clerk with a smart algorithm that works 24/7.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>Fintech models democratize finance by providing services to people who were previously ignored by big banks, such as small businesses or individuals with no credit history. By using AI instead of physical branches, these companies lower costs significantly, passing those savings back to you through lower interest rates and higher investment returns.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="comparison-block">
            <div class="comparison-side left">
                <h4>üîµ Traditional Banking Model</h4>
                <ul><li>Heavy physical infrastructure (branches)</li><li>Manual credit checks and underwriting</li><li>High fees to cover large overhead</li><li>One-size-fits-all financial products</li></ul>
            </div>
            <div class="comparison-divider">vs</div>
            <div class="comparison-side right">
                <h4>üü¢ Fintech Business Models</h4>
                <ul><li>Purely digital/mobile delivery</li><li>AI-driven automated risk assessment</li><li>Low/zero fees through automation</li><li>Hyper-personalized, data-driven services</li></ul>
            </div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Fintech business models work by 'unbundling' traditional banking services into specialized digital categories. Lending (P2P) platforms act as matchmakers, connecting people who have money to lend directly with those who need to borrow, removing the bank's profit margin. Insurance (InsurTech) uses real-time data from devices to price policies based on your actual behavior rather than broad demographics. Wealth Management (Robo-advisors) uses mathematical algorithms to automatically balance your investment portfolio, a task that used to require a wealthy person's budget for a private banker. Mobile payments utilize digital ledgers and encryption to move money instantly across the globe, bypassing the slow and costly settlement systems used by traditional clearinghouses.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>Key areas of application including lending (P2P), insurance (InsurTech), wealth management (Robo-advisors), and mobile payments.</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Instead of waiting two weeks for a bank to approve a small business loan, a baker uses a P2P lending platform. The platform's AI analyzes the bakery's real-time sales data and social media reviews, approving a $10,000 loan in 24 hours at an 8% interest rate, funded by fifty individual investors who each contribute $200. This process bypasses the overhead of a physical bank building and dozens of manual underwriters.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>A common mistake is thinking Fintech is just 'online banking' provided by your current bank. In reality, Fintech refers to specialized companies using technology to fundamentally change the underlying financial logic, such as using AI for risk assessment rather than just putting a paper form on a website.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> Which fintech business model primarily uses automated, algorithm-driven financial planning services with little to no human supervision to manage investment portfolios?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        P2P Lending
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Robo-advisors
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        InsurTech
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Mobile Payments
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Robo-advisors leverage algorithms and data to provide automated wealth management and investment advice based on a user's risk tolerance.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Robo-advisors leverage algorithms and data to provide automated wealth management and investment advice based on a user's risk tolerance.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> How does Peer-to-Peer (P2P) lending differ from the traditional banking model of credit?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        It requires physical collateral for every transaction.
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        It is only available to large institutional corporations.
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        It connects individual lenders directly with borrowers via an online platform, bypassing traditional intermediaries.
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        It relies exclusively on government-issued grants rather than private capital.
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! P2P lending platforms act as matchmakers that allow individuals or businesses to lend and borrow money directly from one another without a traditional bank.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. P2P lending platforms act as matchmakers that allow individuals or businesses to lend and borrow money directly from one another without a traditional bank.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> A company that utilizes data from IoT devices and mobile apps to offer personalized coverage and streamline the claims process is an example of which fintech area?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Mobile Payments
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Robo-advising
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        InsurTech
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        P2P Lending
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! InsurTech refers to the use of technology and data analytics to improve the efficiency, customization, and delivery of insurance products.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. InsurTech refers to the use of technology and data analytics to improve the efficiency, customization, and delivery of insurance products.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-4" class="concept-section">
            <h2>Automated Decision Making</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Think of an automatic thermostat in your home. Instead of you manually checking a thermometer and turning a dial every hour, the device senses the temperature and decides to turn the heat on or off by itself based on rules you previously set.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>In finance, speed is everything; automated systems can process millions of transactions or loan applications per second, which is humanly impossible. It reduces the 'human cost' of operations while allowing services like instant fraud protection to work in real-time.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="diagram-container">
            <div class="diagram-title">Automated Decision Workflow</div>
            <div class="mermaid">
flowchart LR
    A[Data Input] --> B{AI Model}
    B -->|Risk Assessment| C[Automated Decision]
    C --> D[Action Taken]
    D --> E[Monitoring & Regulation]
    style C fill:#4299e1,stroke:#fff,color:#fff
            </div>
            <div class="diagram-caption">The transition from raw data to action without human intervention.</div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Automated Decision Making (ADM) involves using algorithms and AI to perform tasks that traditionally required human intelligence, aiming for 'zero human intervention.' It transforms operations by shifting the focus from 'staffing' (people doing the work) to 'management' (people designing and overseeing the code). While highly efficient, it creates a transparency gap; because the logic is hidden within complex software, it is often harder for regulators to monitor compared to traditional human-led processes. Therefore, the quality of the decision shifts entirely onto the quality of the data and the integrity of the initial model design.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>
## Operations

High quality staff+high quality management. Automated decision making with 0 human intervention.


## Monitoring

Strong and complete regulations. Missing/Incomplete. Hard to monitor.


## Provider
</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>A credit card company uses ADM to prevent theft. If a card is swiped for $2,000 in a country where the user has never traveled, the system analyzes the risk score against billions of other transactions and blocks the card in 0.5 seconds. No human employee reviews the purchase; the 'decision' to block is made entirely by the algorithm based on statistical probability.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Thinking that 'automated' means 'maintenance-free.' In reality, these systems require high-quality management to ensure the algorithm doesn't 'drift' or start making biased decisions as market conditions change.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> According to the operations section, what level of human involvement is required for automated decision making?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Frequent manual overrides
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Zero human intervention
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Human approval for every decision
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Intervention by management only
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The content specifies that operations for automated decision making involve 0 human intervention.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The content specifies that operations for automated decision making involve 0 human intervention.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> What is identified as a primary challenge in the monitoring of automated decision-making systems?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        It is too expensive to maintain
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        It requires too many staff members
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        It is hard to monitor and regulations are often missing
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        It is over-regulated by international laws
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The provided text notes that monitoring is hard and regulations are frequently missing or incomplete.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The provided text notes that monitoring is hard and regulations are frequently missing or incomplete.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> To maintain high-quality operations in automated decision making, what combination of personnel is needed?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Low quality staff and high quality management
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        High quality staff and high quality management
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Entry-level staff and high quality management
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        High quality staff and no management
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The operations section states that high quality staff plus high quality management are necessary for this concept.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The operations section states that high quality staff plus high quality management are necessary for this concept.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-5" class="concept-section">
            <h2>Fintech Regulation</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Think of Fintech regulation as the safety rules and referees at a high-tech amusement park. While the engineers want to build faster, more exciting roller coasters (innovative apps), the referees ensure the brakes work and the tracks are inspected so that a single mechanical failure doesn't cause a park-wide disaster.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>As financial services move from physical banks to digital algorithms, a single coding error or cyberattack could wipe out millions of people's savings instantly. Regulation ensures that these technologies remain reliable, protecting the global economy from systemic collapses triggered by rapid technological shifts.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="diagram-container">
            <div class="diagram-title">The Fintech Regulatory Cycle</div>
            <div class="mermaid">
flowchart TD
    A[Fintech Innovation] --> B[Increased Efficiency & Access]
    A --> C[New Risks: Cyber, AI Bias, Speed]
    C --> D[Regulatory Oversight]
    D --> E[Compliance & Safety Nets]
    E --> F[Market Stability]
    F --> A
            </div>
            <div class="diagram-caption">How regulators balance innovation with safety.</div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Fintech regulation is the strategic oversight applied to technology-driven financial services to ensure they operate within a framework of safety, soundness, and consumer protection. Unlike traditional banking oversight, it must address unique challenges such as algorithmic bias, decentralized finance risks, and the extreme speed of digital transactions. Regulators like the Federal Reserve or the SEC monitor these firms to prevent money laundering, protect user data, and mandate 'capital requirements'‚Äîessentially ensuring a company has enough cash on hand to survive a crisis. The goal is to create a 'Regulatory Sandbox' where innovation can flourish without compromising the stability of the entire financial system.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>The oversight by institutions like the Federal Reserve to manage financial stability and the risks associated with rapid technological shifts.</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Suppose a new Fintech app uses AI to provide instant $500 'payday' loans to millions of users. A regulator might step in to audit the AI's code to ensure it isn't illegally charging higher interest rates to specific demographic groups. Additionally, they might require the app to keep $50 million in a reserve fund to ensure that if a sudden economic downturn happens and users can't pay back the loans, the app doesn't collapse and trigger a wider financial panic.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Students often assume regulation is intended to slow down or block innovation to protect old-fashioned banks. In reality, the primary goal is 'financial stability'‚Äîallowing new tech to exist while making sure it doesn't accidentally break the economy.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> What is a primary objective of regulatory bodies like the Federal Reserve when overseeing the fintech sector?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        To eliminate all competition for traditional banking institutions
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        To ensure financial stability and manage risks arising from rapid technological shifts
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        To mandate that all fintech companies operate without profit
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        To prevent the use of digital technology in financial transactions
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Regulatory oversight aims to balance innovation with systemic stability to protect the broader economy from risks associated with new financial technologies.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Regulatory oversight aims to balance innovation with systemic stability to protect the broader economy from risks associated with new financial technologies.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> Why is the Federal Reserve concerned with 'rapid technological shifts' within the financial industry?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="true">
                        Because these shifts can introduce systemic risks that may threaten financial stability
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Because technological shifts are guaranteed to decrease the value of the dollar
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Because the Federal Reserve is responsible for manufacturing hardware for fintech firms
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Because rapid shifts typically lead to a complete lack of consumer interest in banking
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! The speed of fintech innovation requires institutions to monitor how new technologies might impact the stability and safety of the global financial infrastructure.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. The speed of fintech innovation requires institutions to monitor how new technologies might impact the stability and safety of the global financial infrastructure.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> Fintech regulation involves managing the balance between which two factors?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        High taxes and low interest rates
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Physical bank branches and online-only platforms
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Technological innovation and the mitigation of financial system risks
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        International trade agreements and local credit union policies
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Effective regulation seeks to encourage the benefits of technological growth while implementing safeguards against the volatility those shifts might cause.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Effective regulation seeks to encourage the benefits of technological growth while implementing safeguards against the volatility those shifts might cause.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-6" class="concept-section">
            <h2>Institutional Integration</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Imagine a massive, centuries-old library that wants to start offering audiobooks. Instead of recording every book themselves, they might hire a tech startup to build their app, allow a startup to set up a booth in the lobby, or simply buy the tech company outright to own the digital rights.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>Traditional banks possess the trust, licenses, and capital, but they move too slowly to build every new technology from scratch. Integration allows them to survive the digital age by adopting innovation through collaboration rather than trying to out-innovate tech companies on their own.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="diagram-container">
            <div class="diagram-title">Spectrum of Institutional Integration</div>
            <div class="mermaid">
flowchart LR
    A[Traditional Bank] --> B{Integration Type}
    B --> C[Incubation: Mentoring & Early Funding]
    B --> D[Partnership: Service Sharing]
    B --> E[White Labeling: Buying & Rebranding Software]
    B --> F[Acquisition: Full Ownership & Integration]
            </div>
            <div class="diagram-caption">Levels of engagement between traditional banks and fintech firms ranging from low to high commitment.</div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Institutional integration is the strategic framework by which legacy financial institutions absorb the agility of the fintech sector. It exists on a spectrum of involvement: incubation involves nurturing startups at an early stage to gain insights; partnerships allow banks to offer a fintech's service to their existing customers; white labeling occurs when a bank rebrands a fintech's software as its own; and acquisition is the total purchase of a startup to internalize its technology and talent. This allows banks to modernize their 'front-end' user experience while keeping their 'back-end' regulatory and capital structures intact.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>The various ways traditional banks engage with fintech, such as through partnerships, incubation, white labeling, and acquisitions.</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>When Goldman Sachs launched 'Marcus,' its digital bank, it didn't just build everything internally; it used a mix of strategies including acquiring the fintech startup 'Clarity Money' to instantly gain a sophisticated personal finance management tool for its users. This saved years of development time and provided an immediate user base of over one million people.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Thinking that integration always means the bank 'buys' the fintech company. In reality, many integrations are loose partnerships where the fintech remains independent and simply rents its technology to the bank.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> Which form of institutional integration involves a traditional bank rebranding a fintech company's technology to offer it to customers as their own proprietary service?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Incubation
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        White Labeling
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Acquisition
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Strategic Partnership
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! White labeling allows a bank to use a fintech's backend technology while maintaining its own branding and customer interface.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. White labeling allows a bank to use a fintech's backend technology while maintaining its own branding and customer interface.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> When a traditional bank provides early-stage fintech startups with office space, mentorship, and funding to foster innovation, this is known as:
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Divestment
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        White Labeling
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        Incubation
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Asset Liquidation
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Incubation programs are designed to nurture startups in their early stages, providing the bank with early access to emerging technologies.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Incubation programs are designed to nurture startups in their early stages, providing the bank with early access to emerging technologies.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> Which integration strategy allows a bank to gain full control over a fintech's intellectual property and talent by absorbing the startup into its corporate structure?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="true">
                        Acquisition
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Outsourcing
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Franchising
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Joint Venture
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Acquisitions involve purchasing a fintech company outright to fully integrate its technology, customer base, and expertise into the bank.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Acquisitions involve purchasing a fintech company outright to fully integrate its technology, customer base, and expertise into the bank.
                    </div>
                </div>
                
        </section>
        
        <section id="concept-7" class="concept-section">
            <h2>Blockchain and Crowdfunding</h2>
            
            <!-- Simple Analogy -->
            <div class="feynman-block" style="border-left-color: var(--accent-primary);">
                <h4>Simple Analogy</h4>
                <p>Imagine a neighborhood digital notebook where every neighbor has an identical copy that updates instantly. Instead of one person holding the notebook and charging a fee to manage it, the whole neighborhood uses it to pool their money together to build a shared playground, with the notebook automatically tracking exactly how much each person contributed.</p>
            </div>
            
            <!-- Why It Matters -->
            <div class="feynman-block" style="border-left-color: var(--accent-secondary);">
                <h4>Why This Matters</h4>
                <p>This technology removes expensive 'middlemen' like banks and legal firms, making it cheaper for entrepreneurs to raise money. It also opens up high-value investments, like real estate or fine art, to regular people who can now buy tiny, affordable shares of those assets.</p>
            </div>
            
            <!-- Visualization -->
            
        <div class="diagram-container">
            <div class="diagram-title">Traditional vs. Blockchain Capital Raising</div>
            <div class="mermaid">
flowchart LR
    subgraph Traditional
    A[Entrepreneur] --> B[Bank/Broker]
    B --> C[Legal/Compliance]
    C --> D[Investor]
    end
    subgraph Blockchain
    E[Entrepreneur] --> F{Smart Contract}
    F --> G[Global Investors]
    G -- Funds --> F
    F -- Tokens --> G
    end
            </div>
            <div class="diagram-caption">Blockchain removes intermediaries to connect investors directly with projects.</div>
        </div>
        
            
            <!-- Deep Explanation -->
            <div class="expandable">
                <div class="expandable-header">
                    <span>Deep Dive: Detailed Explanation</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>Blockchain crowdfunding works by turning ownership rights into digital 'tokens' on a distributed ledger. Unlike traditional systems that rely on a central bank or platform to verify transactions, the blockchain uses a network of computers to confirm and record every contribution. This creates a transparent, tamper-proof history of who owns what. Smart contracts‚Äîself-executing code‚Äîcan then automatically distribute profits or voting rights to investors without any manual intervention, ensuring that the rules of the capital raising are followed exactly as programmed.</p>
                        <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.95rem; color: var(--text-tertiary);"><strong>From lecture:</strong><br>The use of distributed ledger technology for securitization and alternative methods of capital raising.</div>
                    </div>
                </div>
            </div>
            
            <!-- Practical Example -->
            <div class="expandable open">
                <div class="expandable-header">
                    <span>Practical Example</span>
                    <span class="expandable-icon">‚ñº</span>
                </div>
                <div class="expandable-content">
                    <div class="expandable-content-inner">
                        <p>A startup building a $1 million wind farm issues 10,000 digital tokens at $100 each on a blockchain. Instead of waiting months for a bank loan, they collect funds from 500 global investors in days. Once the wind farm starts selling electricity, a smart contract automatically sends a percentage of the revenue directly to each investor's digital wallet based on the number of tokens they hold.</p>
                    </div>
                </div>
            </div>
            
            <!-- Common Mistakes -->
            <div class="feynman-block" style="border-left-color: var(--accent-warning);">
                <h4>Common Mistakes</h4>
                <p>Many students think blockchain crowdfunding is just about donating 'magic internet money' like Bitcoin. In reality, the technology is being used to represent legal ownership in real-world, regulated assets like commercial buildings, private equity, and infrastructure.</p>
            </div>
            
            <!-- Quiz Questions -->
            
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 1:</strong> Which feature of blockchain technology is most critical for improving investor trust in decentralized crowdfunding platforms?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        Centralized management by a single financial intermediary
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        The immutability and transparency of the distributed ledger
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        The ability for platform owners to reverse transactions at will
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        A requirement for all investors to be physically present during funding
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Blockchain's immutable and transparent ledger ensures that all contributions and fund allocations are verifiable by all participants, reducing the risk of fraud.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Blockchain's immutable and transparent ledger ensures that all contributions and fund allocations are verifiable by all participants, reducing the risk of fraud.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 2:</strong> In the context of blockchain-based securitization, what does the term 'tokenization' primarily refer to?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="true">
                        Converting ownership rights of an asset into digital tokens on a blockchain
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Creating a digital loyalty program for retail customers
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        Encrypting a user's password to prevent unauthorized account access
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        The process of printing physical stock certificates with QR codes
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! Tokenization allows for the fractionalization of assets like real estate or private equity, enabling them to be traded as digital securities on a distributed ledger.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. Tokenization allows for the fractionalization of assets like real estate or private equity, enabling them to be traded as digital securities on a distributed ledger.
                    </div>
                </div>
                
                <div class="quiz-container">
                    <div class="quiz-question">
                        <strong>Question 3:</strong> How do Security Token Offerings (STOs) differ from traditional Initial Coin Offerings (ICOs) in capital raising?
                    </div>
                    <div class="quiz-options">
                        
                    <div class="quiz-option" data-correct="false">
                        ICOs are always backed by physical assets, whereas STOs are purely digital
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        STOs are unregulated and do not require any legal compliance
                    </div>
                    
                    <div class="quiz-option" data-correct="true">
                        STOs represent an investment in an underlying asset and are typically subject to securities regulations
                    </div>
                    
                    <div class="quiz-option" data-correct="false">
                        ICOs are the only method that utilizes smart contracts for fund distribution
                    </div>
                    
                    </div>
                    <div class="quiz-feedback correct">
                        ‚úì Correct! STOs are specifically designed to function as digital securities, providing investors with legal claims to assets or profits while adhering to regulatory frameworks.
                    </div>
                    <div class="quiz-feedback incorrect">
                        ‚úó Not quite. STOs are specifically designed to function as digital securities, providing investors with legal claims to assets or profits while adhering to regulatory frameworks.
                    </div>
                </div>
                
        </section>
        
            
            <!-- Completion -->
            <div style="margin-top: 4rem; padding: 2rem; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); border-radius: 12px; text-align: center; color: white;">
                <h3 style="margin-bottom: 1rem;">Course Complete!</h3>
                <p>You've reviewed all 7 main concepts. Keep practicing with the quizzes above.</p>
            </div>
        </main>

        <div class="column-resizer" id="resizerRight" role="separator" aria-orientation="vertical" aria-label="Resize right sidebar"></div>

        <!-- Right Sidebar: AI Assistant & Tools -->
        <aside class="sidebar-right">
            <div class="ai-chat">
                <div class="ai-chat-header">
                    <div>
                        <h3 style="margin: 0;">AI Study Assistant</h3>
                        <p style="font-size: 0.8rem; color: var(--text-tertiary); margin: 0;">Powered by Gemini</p>
                    </div>
                </div>
                
                <div class="ai-chat-messages" id="aiMessages">
                    <div class="ai-message assistant">
                        Hi! I'm your AI study assistant. Ask me anything about this topic, or request:
                        <ul style="margin-top: 0.5rem; padding-left: 1.5rem; font-size: 0.9rem;">
                            <li>Explanations in simpler terms</li>
                            <li>More examples</li>
                            <li>Practice questions</li>
                            <li>Connections to other concepts</li>
                        </ul>
                    </div>
                </div>
                
                <div class="ai-input-group">
                    <input 
                        type="text" 
                        class="ai-input" 
                        id="aiInput" 
                        placeholder="Ask a question..."
                        onkeypress="if(event.key==='Enter') sendAIMessage()"
                    />
                    <button class="ai-send-btn" onclick="sendAIMessage()">Send</button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div style="margin-top: 2rem;">
                <h4 style="margin-bottom: 1rem; color: var(--text-tertiary);">Quick Actions</h4>
                <button onclick="reviewAllQuizzes()" class="action-btn">
                    Review All Quizzes
                </button>
                <button onclick="createSummary()" class="action-btn">
                    Generate Summary
                </button>
                <button onclick="window.print()" class="action-btn">
                    Print Notes
                </button>
            </div>
            
            <!-- Keyboard Shortcuts -->
            <div style="margin-top: 2rem; padding: 1rem; background: var(--bg-elevated); border-radius: 8px; font-size: 0.85rem;">
                <h5 style="margin-bottom: 0.75rem; color: var(--text-tertiary);">Shortcuts</h5>
                <div id="shortcutsDisplay" style="color: var(--text-secondary); line-height: 1.8;">
                    <div><kbd id="shortcutFocusAI">Alt+A</kbd> Focus AI</div>
                    <div><kbd id="shortcutSummary">Alt+S</kbd> Summary</div>
                </div>
            </div>
        </aside>
    </div>

    <script>
        
        // ‚îÄ‚îÄ Gemini Proxy Configuration ‚îÄ‚îÄ
        const GEMINI_PROXY_URL = '../api/gemini';
        const LAYOUT_STORAGE_KEY = 'learning-layout-widths-v1';
        
        let courseContext = '';
        let conversationHistory = [];

        function escapeHtml(value) {
            return String(value ?? '')
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        }
        
        // ‚îÄ‚îÄ Main Controller ‚îÄ‚îÄ
        class LearningPageController {
            constructor() {
                this.isMac = /Mac|iPhone|iPod|iPad/i.test(navigator.platform);
                this.setupExpandables();
                this.setupQuizzes();
                this.setupProgressTracking();
                this.setupScrollReveal();
                this.setupCourseContext();
                this.setupKeyboardShortcuts();
                this.initializeMermaid();
                this.initializeCharts();
                this.updateShortcutsDisplay();
                this.setupColumnResizers();
            }
            
            initializeMermaid() {
                if (typeof mermaid !== 'undefined') {
                    mermaid.initialize({
                        startOnLoad: true,
                        theme: 'dark',
                        themeVariables: {
                            primaryColor: '#263352',
                            primaryTextColor: '#edf2f7',
                            primaryBorderColor: '#f6c177',
                            lineColor: '#a0aec0',
                            secondaryColor: '#1f2b47',
                            tertiaryColor: '#1c2a45',
                            background: '#16213e',
                            mainBkg: '#263352',
                            nodeBorder: '#f6c177',
                            clusterBkg: '#1f2b47',
                            fontSize: '14px'
                        },
                        flowchart: { curve: 'basis', padding: 20 },
                        sequence: { actorMargin: 50 }
                    });
                }
            }
            
            initializeCharts() {
                if (typeof Chart !== 'undefined') {
                    Chart.defaults.color = '#a0aec0';
                    Chart.defaults.borderColor = 'rgba(255,255,255,0.06)';
                    Chart.defaults.font.family = "-apple-system, 'Helvetica Neue', sans-serif";
                    Chart.defaults.responsive = true;
                    Chart.defaults.maintainAspectRatio = true;
                    Chart.defaults.plugins.legend.labels.usePointStyle = true;
                }
            }
            
            setupCourseContext() {
                const mc = document.querySelector('.main-content');
                if (mc) courseContext = mc.innerText.substring(0, 6000);
            }
            
            setupExpandables() {
                document.querySelectorAll('.expandable-header').forEach(header => {
                    header.addEventListener('click', () => {
                        header.parentElement.classList.toggle('open');
                    });
                });
            }
            
            setupQuizzes() {
                document.querySelectorAll('.quiz-option').forEach(opt => {
                    opt.addEventListener('click', () => this.handleQuiz(opt));
                });
            }

            handleQuiz(option) {
                const quiz = option.closest('.quiz-container');
                const isCorrect = option.dataset.correct === 'true';
                
                quiz.querySelectorAll('.quiz-option').forEach(o => {
                    o.classList.remove('selected','correct','incorrect');
                });
                
                option.classList.add('selected');
                option.classList.add(isCorrect ? 'correct' : 'incorrect');
                
                if (!isCorrect) {
                    quiz.querySelectorAll('.quiz-option').forEach(o => {
                        if (o.dataset.correct === 'true') o.classList.add('correct');
                    });
                }
                
                const cf = quiz.querySelector('.quiz-feedback.correct');
                const ic = quiz.querySelector('.quiz-feedback.incorrect');
                if (isCorrect) { cf.classList.add('show'); ic.classList.remove('show'); }
                else { ic.classList.add('show'); cf.classList.remove('show'); }
            }

            
            setupProgressTracking() {
                window.addEventListener('scroll', () => {
                    const h = document.documentElement.scrollHeight - window.innerHeight;
                    const p = h > 0 ? Math.min((window.scrollY / h) * 100, 100) : 0;
                    document.getElementById('progressBar').style.width = p + '%';
                });
            }
            
            setupScrollReveal() {
                const obs = new IntersectionObserver((entries) => {
                    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('revealed'); });
                }, { threshold: 0.08 });
                document.querySelectorAll('.reveal-on-scroll').forEach(el => obs.observe(el));
            }
            
            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if (e.altKey && e.key === 'a') {
                        e.preventDefault();
                        document.getElementById('aiInput')?.focus();
                    }
                    if (e.altKey && e.key === 's') {
                        e.preventDefault();
                        askSummary();
                    }
                });
            }
            
            updateShortcutsDisplay() {
                const prefix = this.isMac ? '‚å•' : 'Alt+';
                const focusEl = document.getElementById('shortcutFocusAI');
                const summaryEl = document.getElementById('shortcutSummary');
                if (focusEl) focusEl.textContent = prefix + 'A';
                if (summaryEl) summaryEl.textContent = prefix + 'S';
            }

            setupColumnResizers() {
                if (window.matchMedia('(max-width: 1200px)').matches) return;
                const container = document.querySelector('.page-container');
                const leftResizer = document.getElementById('resizerLeft');
                const rightResizer = document.getElementById('resizerRight');
                if (!container || !leftResizer || !rightResizer) return;

                const minLeft = 200, maxLeft = 560;
                const minRight = 220, maxRight = 560;
                const minMain = 520;
                let leftWidth = 260;
                let rightWidth = 300;

                const clamp = (n, min, max) => Math.max(min, Math.min(max, n));
                const applyWidths = () => {
                    container.style.setProperty('--left-width', leftWidth + 'px');
                    container.style.setProperty('--right-width', rightWidth + 'px');
                };
                const getTotalWidth = () => container.getBoundingClientRect().width - 16;
                const clampAll = () => {
                    const total = getTotalWidth();
                    leftWidth = clamp(leftWidth, minLeft, maxLeft);
                    rightWidth = clamp(rightWidth, minRight, maxRight);
                    if (total - leftWidth - rightWidth < minMain) {
                        const overflow = minMain - (total - leftWidth - rightWidth);
                        leftWidth = clamp(leftWidth - overflow / 2, minLeft, maxLeft);
                        rightWidth = clamp(rightWidth - overflow / 2, minRight, maxRight);
                        if (total - leftWidth - rightWidth < minMain) {
                            const rightCap = clamp(total - leftWidth - minMain, minRight, maxRight);
                            rightWidth = rightCap;
                            leftWidth = clamp(total - rightWidth - minMain, minLeft, maxLeft);
                        }
                    }
                };

                try {
                    const cached = JSON.parse(localStorage.getItem(LAYOUT_STORAGE_KEY) || '{}');
                    if (Number.isFinite(cached.left)) leftWidth = cached.left;
                    if (Number.isFinite(cached.right)) rightWidth = cached.right;
                } catch {}
                clampAll();
                applyWidths();

                const startDrag = (side) => (evt) => {
                    evt.preventDefault();
                    const rect = container.getBoundingClientRect();
                    const total = getTotalWidth();
                    const onMove = (moveEvt) => {
                        if (side === 'left') {
                            const rawLeft = moveEvt.clientX - rect.left;
                            const maxAllowed = Math.min(maxLeft, total - rightWidth - minMain);
                            leftWidth = clamp(rawLeft, minLeft, Math.max(minLeft, maxAllowed));
                        } else {
                            const rawRight = rect.right - moveEvt.clientX;
                            const maxAllowed = Math.min(maxRight, total - leftWidth - minMain);
                            rightWidth = clamp(rawRight, minRight, Math.max(minRight, maxAllowed));
                        }
                        applyWidths();
                    };
                    const stopMove = () => {
                        document.body.style.userSelect = '';
                        document.body.style.cursor = '';
                        leftResizer.classList.remove('dragging');
                        rightResizer.classList.remove('dragging');
                        localStorage.setItem(LAYOUT_STORAGE_KEY, JSON.stringify({ left: leftWidth, right: rightWidth }));
                        document.removeEventListener('pointermove', onMove);
                        document.removeEventListener('pointerup', stopMove);
                    };
                    document.body.style.userSelect = 'none';
                    document.body.style.cursor = 'col-resize';
                    (side === 'left' ? leftResizer : rightResizer).classList.add('dragging');
                    document.addEventListener('pointermove', onMove);
                    document.addEventListener('pointerup', stopMove);
                };

                leftResizer.addEventListener('pointerdown', startDrag('left'));
                rightResizer.addEventListener('pointerdown', startDrag('right'));
                window.addEventListener('resize', () => {
                    if (window.matchMedia('(max-width: 1200px)').matches) return;
                    clampAll();
                    applyWidths();
                });
            }
        }
        
        // ‚îÄ‚îÄ AI Chat (Real Gemini API) ‚îÄ‚îÄ
        async function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const msg = input.value.trim();
            if (!msg) return;
            
            appendMsg('user', msg);
            input.value = '';
            input.disabled = true;
            
            const typingEl = appendMsg('assistant', '<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>');
            
            try {
                const answer = await callGemini(msg);
                typingEl.innerHTML = formatMd(answer);
            } catch (err) {
                const errMsg = err?.message || String(err);
                let hint = 'Check console for details.';
                if (window.location.protocol === 'file:' || errMsg.includes('Failed to fetch')) {
                    const current = window.location.pathname.split('/').pop();
                    hint = `Start local server: python3 serve.py --open html/${current} and ensure GEMINI_API_KEY exists in .env.local`;
                }
                typingEl.innerHTML = '‚ö†Ô∏è Error: ' + escapeHtml(errMsg) + '<br><small>' + escapeHtml(hint) + '</small>';
                console.error('Gemini API error:', err);
            } finally {
                input.disabled = false;
                input.focus();
            }
        }
        
        async function callGemini(userMessage) {
            if (window.location.protocol === 'file:') {
                throw new Error('This page is opened as file:// and cannot reach ../api/gemini');
            }

            const prompt = `You are a concise study assistant for this course.

Course content (excerpt):
${courseContext.substring(0, 3500)}

Previous conversation:
${conversationHistory.slice(-4).map(m => m.role + ': ' + m.content).join('\n')}

Student question: ${userMessage}

Instructions:
- Answer in 3-6 sentences, be direct and complete
- Always finish your sentences, never leave a thought incomplete
- Use the course content as reference
- If the question is in Chinese, answer in Chinese`;

            const res = await fetch(GEMINI_PROXY_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    prompt: prompt,
                    generationConfig: { temperature: 0.7, maxOutputTokens: 1024 }
                })
            });
            
            if (!res.ok) {
                const errText = await res.text();
                throw new Error(`API ${res.status}: ${errText.substring(0, 200)}`);
            }
            
            const data = await res.json();
            const candidate = data.candidates?.[0];
            const answer = candidate?.content?.parts?.[0]?.text;
            if (!answer) throw new Error('Empty response from API');
            
            // Check if response was truncated
            if (candidate?.finishReason === 'MAX_TOKENS') {
                conversationHistory.push({ role: 'user', content: userMessage }, { role: 'assistant', content: answer });
                return answer + '...\n\n_(Response was trimmed. Ask a follow-up for more detail.)_';
            }
            
            conversationHistory.push({ role: 'user', content: userMessage }, { role: 'assistant', content: answer });
            return answer;
        }
        
        function appendMsg(role, html) {
            const container = document.getElementById('aiMessages');
            const div = document.createElement('div');
            div.className = 'ai-message ' + role;
            div.innerHTML = html;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return div;
        }
        
        function formatMd(text) {
            return text
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/`(.+?)`/g, '<code style="background:var(--bg-tertiary);padding:0.1em 0.4em;border-radius:3px;font-size:0.9em;">$1</code>')
                .replace(/\n/g, '<br>');
        }
        
        function askSummary() {
            const input = document.getElementById('aiInput');
            input.value = 'Please summarize the key concepts of this lesson in bullet points.';
            sendAIMessage();
        }
        
        function reviewAllQuizzes() {
            const q = document.querySelector('.quiz-container');
            if (q) q.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        function createSummary() { askSummary(); }
        
        // ‚îÄ‚îÄ Sidebar Tabs ‚îÄ‚îÄ
        function switchSidebarTab(tabName) {
            document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.sidebar-panel').forEach(p => p.style.display = 'none');
            document.querySelector(`.sidebar-tab[data-tab="${tabName}"]`)?.classList.add('active');
            const panel = document.getElementById('panel-' + tabName);
            if (panel) panel.style.display = 'block';
        }
        
        // ‚îÄ‚îÄ Notes System ‚îÄ‚îÄ
        const NOTES_STORAGE_KEY = 'learning-notes-' + document.title;
        const NOTES_FOCUS_KEY = NOTES_STORAGE_KEY + '-focus';
        const NOTES_ACTIVE_KEY = NOTES_STORAGE_KEY + '-active';
        const NOTES_DRAFT_KEY = NOTES_STORAGE_KEY + '-draft';
        
        function loadNotes() {
            try {
                const raw = JSON.parse(localStorage.getItem(NOTES_STORAGE_KEY) || '[]');
                if (!Array.isArray(raw)) return [];
                return raw.map((n, idx) => {
                    const idNum = Number(n?.id);
                    return {
                        id: Number.isFinite(idNum) ? idNum : -(idx + 1),
                        citation: typeof n?.citation === 'string' ? n.citation : (typeof n?.quote === 'string' ? n.quote : ''),
                        body: typeof n?.body === 'string' ? n.body : (typeof n?.text === 'string' ? n.text : (typeof n?.content === 'string' ? n.content : '')),
                        section: typeof n?.section === 'string' ? n.section : (typeof n?.title === 'string' ? n.title : ''),
                        timestamp: typeof n?.timestamp === 'string' && n.timestamp
                            ? n.timestamp
                            : (typeof n?.created_at === 'string' && n.created_at ? n.created_at : new Date().toISOString())
                    };
                });
            }
            catch { return []; }
        }
        
        function saveNotes(notes) {
            localStorage.setItem(NOTES_STORAGE_KEY, JSON.stringify(notes));
            renderNotes();
        }

        function saveDraft(text) {
            localStorage.setItem(NOTES_DRAFT_KEY, text || '');
        }

        function loadDraft() {
            return localStorage.getItem(NOTES_DRAFT_KEY) || '';
        }

        function renderDraftPreview(text) {
            const preview = document.getElementById('noteDraftPreviewContent');
            if (!preview) return;
            const clean = text || '';
            if (!clean.trim()) {
                preview.innerHTML = '<span style="color: var(--text-tertiary);">Type in the note box to preview Markdown rendering in real time.</span>';
                return;
            }
            preview.innerHTML = renderNoteMarkdown(clean);
        }

        function handleNoteInputChange(value) {
            saveDraft(value);
            renderDraftPreview(value);
        }

        function initNoteComposer() {
            const input = document.getElementById('noteInput');
            if (!input) return;
            const draft = loadDraft();
            input.value = draft;
            renderDraftPreview(draft);
            input.addEventListener('input', () => {
                handleNoteInputChange(input.value);
            });
            input.addEventListener('keydown', (e) => {
                if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') {
                    e.preventDefault();
                    addFreeNote();
                }
            });
        }

        function getFocusedNoteId() {
            const value = localStorage.getItem(NOTES_FOCUS_KEY);
            return value ? Number(value) : null;
        }

        function getActiveNoteId() {
            const value = localStorage.getItem(NOTES_ACTIVE_KEY);
            return value ? Number(value) : null;
        }

        function setFocusedNoteId(id) {
            if (!id) localStorage.removeItem(NOTES_FOCUS_KEY);
            else localStorage.setItem(NOTES_FOCUS_KEY, String(id));
        }

        function setActiveNoteId(id) {
            if (!id) localStorage.removeItem(NOTES_ACTIVE_KEY);
            else localStorage.setItem(NOTES_ACTIVE_KEY, String(id));
        }

        function toggleFocusNote(id, e) {
            e?.stopPropagation();
            const focusedId = getFocusedNoteId();
            setFocusedNoteId(focusedId === id ? null : id);
            renderNotes();
        }

        function openNote(id) {
            setActiveNoteId(id);
            renderNotes();
            switchSidebarTab('notes');
        }

        function ensureNoteReader() {
            const panel = document.getElementById('panel-notes');
            const notesList = document.getElementById('notesList');
            if (!panel || !notesList) return null;
            notesList.style.maxHeight = '32vh';

            let reader = document.getElementById('noteReader');
            if (!reader) {
                reader = document.createElement('div');
                reader.id = 'noteReader';
                reader.className = 'note-reader';
                notesList.insertAdjacentElement('afterend', reader);
            }
            return reader;
        }

        function renderNoteMarkdown(text) {
            return escapeHtml(text || '')
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/`(.+?)`/g, '<code>$1</code>')
                .replace(/\n/g, '<br>');
        }

        function renderNoteReader(notes) {
            const reader = ensureNoteReader();
            if (!reader) return;
            if (notes.length === 0) {
                reader.innerHTML = '<div class="reader-title">Reader</div><div class="reader-content">No notes yet.</div>';
                return;
            }

            let activeId = getActiveNoteId();
            let active = notes.find(n => n.id === activeId);
            if (!active) {
                active = notes[0];
                setActiveNoteId(active.id);
            }
            const time = new Date(active.timestamp).toLocaleString();
            const citationHtml = active.citation ? `<div class="note-citation">${escapeHtml(active.citation)}</div>` : '';
            const activeBody = typeof active.body === 'string' ? active.body : '';
            reader.innerHTML = `
                <div class="reader-title">Reading ‚Ä¢ ${escapeHtml(active.section || 'General')} ‚Ä¢ ${time}</div>
                ${citationHtml}
                <div class="reader-content">${renderNoteMarkdown(activeBody)}</div>
            `;
        }
        
        function addNote(citation, body, section) {
            const notes = loadNotes();
            const note = {
                id: Date.now(),
                citation: citation || '',
                body: body || '',
                section: section || '',
                timestamp: new Date().toISOString()
            };
            notes.push(note);
            setActiveNoteId(note.id);
            saveNotes(notes);
            // Switch to notes tab
            switchSidebarTab('notes');
        }
        
        function addFreeNote() {
            const input = document.getElementById('noteInput');
            const text = input.value.trim();
            if (!text) return;
            addNote('', text, '');
            input.value = '';
            saveDraft('');
            renderDraftPreview('');
        }
        
        function deleteNote(id, e) {
            e?.stopPropagation();
            const notes = loadNotes().filter(n => n.id !== id);
            if (getFocusedNoteId() === id) setFocusedNoteId(null);
            if (getActiveNoteId() === id) setActiveNoteId(notes.length ? notes[0].id : null);
            saveNotes(notes);
        }
        
        function renderNotes() {
            const notes = loadNotes();
            const container = document.getElementById('notesList');
            const counter = document.getElementById('notesCount');
            if (!container) return;
            
            counter.textContent = notes.length + ' note' + (notes.length !== 1 ? 's' : '');
            
            if (notes.length === 0) {
                container.innerHTML = '<p style="font-size:0.85rem; color:var(--text-tertiary); text-align:center; padding:2rem 0;">Select text and click "Add Note" to begin, or write freely below.</p>';
                renderNoteReader(notes);
                return;
            }

            const focusedId = getFocusedNoteId();
            const activeId = getActiveNoteId();
            const sortedNotes = [...notes].sort((a, b) => {
                const aFocused = a.id === focusedId ? 1 : 0;
                const bFocused = b.id === focusedId ? 1 : 0;
                if (aFocused !== bFocused) return bFocused - aFocused;
                return new Date(b.timestamp) - new Date(a.timestamp);
            });

            container.innerHTML = sortedNotes.map(n => {
                const time = new Date(n.timestamp).toLocaleString();
                const citationHtml = n.citation 
                    ? `<div class="note-citation">${escapeHtml(n.citation)}</div>` 
                    : '';
                const noteBody = typeof n.body === 'string' ? n.body : '';
                const preview = noteBody.length > 140 ? (noteBody.slice(0, 140) + '...') : noteBody;
                const focusLabel = n.id === focusedId ? 'Unfocus' : 'Focus';
                return `<div class="note-card ${n.id === activeId ? 'active' : ''} ${n.id === focusedId ? 'focused' : ''}" onclick="openNote(${n.id})">
                    ${citationHtml}
                    <div class="note-body">${escapeHtml(preview)}</div>
                    <div class="note-meta">
                        <span>${n.section ? escapeHtml(n.section) : ''} ${time}</span>
                        <span>
                            <button class="note-focus" onclick="toggleFocusNote(${n.id}, event)">${focusLabel}</button>
                            <button class="note-delete" onclick="deleteNote(${n.id}, event)">Delete</button>
                        </span>
                    </div>
                </div>`;
            }).join('');
            renderNoteReader(sortedNotes);
        }
        
        function exportNotesToObsidian() {
            const notes = loadNotes();
            if (notes.length === 0) { alert('No notes to export.'); return; }
            
            const title = document.title.replace(' - Interactive Learning', '');
            const sourceFile = document.querySelector('.main-content header p')?.textContent?.match(/Source: (.+)/)?.[1] || '';
            
            let md = `---
tags: [lecture-notes, mfin7034]
source: "${sourceFile}"
date: ${new Date().toISOString().split('T')[0]}
---

`;
            md += `# ${title}

`;
            md += `> [!info] Source
> PDF: [[${sourceFile.replace('.pdf','')}]]

`;
            
            notes.forEach((n, idx) => {
                if (n.citation) {
                    md += `> [!quote] Highlight
> ${n.citation}

`;
                }
                const noteBody = typeof n.body === 'string' ? n.body : '';
                md += noteBody + `

`;
                if (idx < notes.length - 1) md += `---

`;
            });
            
            md += `
## References

- Source: ${sourceFile}
- Generated: ${new Date().toLocaleString()}
`;
            
            const blob = new Blob([md], { type: 'text/markdown;charset=utf-8' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = title.replace(/[^a-zA-Z0-9‰∏Ä-Èøø ]/g, '_') + '.md';
            a.click();
            URL.revokeObjectURL(a.href);
        }
        
        // ‚îÄ‚îÄ Text Highlight & Selection ‚îÄ‚îÄ
        const highlightTooltip = document.createElement('div');
        highlightTooltip.className = 'highlight-tooltip';
        highlightTooltip.innerHTML = `
            <button onclick="highlightSelection()">Highlight</button>
            <button onclick="highlightAndNote()">+ Note</button>
        `;
        document.body.appendChild(highlightTooltip);
        
        document.addEventListener('mouseup', (e) => {
            const sel = window.getSelection();
            const text = sel.toString().trim();
            
            // Only show for selections within main content
            const main = document.querySelector('.main-content');
            if (!text || text.length < 3 || !main?.contains(sel.anchorNode)) {
                highlightTooltip.classList.remove('show');
                return;
            }
            
            const range = sel.getRangeAt(0);
            const rect = range.getBoundingClientRect();
            highlightTooltip.style.left = rect.left + (rect.width / 2) - 60 + 'px';
            highlightTooltip.style.top = rect.top - 40 + window.scrollY + 'px';
            highlightTooltip.classList.add('show');
        });
        
        document.addEventListener('mousedown', (e) => {
            if (!highlightTooltip.contains(e.target)) {
                highlightTooltip.classList.remove('show');
            }
        });
        
        function highlightSelection() {
            const sel = window.getSelection();
            if (!sel.rangeCount) return;
            const range = sel.getRangeAt(0);
            const mark = document.createElement('mark');
            mark.className = 'text-highlight';
            try {
                range.surroundContents(mark);
            } catch(e) {
                // Cross-element selection: fall back
                const text = sel.toString();
                mark.textContent = text;
                range.deleteContents();
                range.insertNode(mark);
            }
            sel.removeAllRanges();
            highlightTooltip.classList.remove('show');
        }
        
        function highlightAndNote() {
            const sel = window.getSelection();
            const text = sel.toString().trim();
            if (!text) return;
            
            // Find section context
            let section = '';
            let node = sel.anchorNode;
            while (node && node !== document.body) {
                if (node.classList?.contains('concept-section')) {
                    const h2 = node.querySelector('h2');
                    if (h2) section = h2.textContent;
                    break;
                }
                node = node.parentNode;
            }
            
            highlightSelection();
            
            openInlineSelectionNoteEditor(text, section, sel.getRangeAt(0).getBoundingClientRect());
        }
        

        function closeInlineSelectionNoteEditor() {
            document.getElementById('inlineSelectionNoteEditor')?.remove();
        }

        function openInlineSelectionNoteEditor(selectionText, section, rect) {
            closeInlineSelectionNoteEditor();
            const editor = document.createElement('div');
            editor.id = 'inlineSelectionNoteEditor';
            editor.style.position = 'absolute';
            editor.style.zIndex = '10030';
            editor.style.width = 'min(420px, 90vw)';
            editor.style.background = 'var(--bg-card)';
            editor.style.border = '1px solid var(--border-color)';
            editor.style.borderRadius = '12px';
            editor.style.boxShadow = '0 16px 36px rgba(0,0,0,0.32)';
            editor.style.padding = '0.65rem';
            editor.style.top = (window.scrollY + rect.bottom + 10) + 'px';
            editor.style.left = Math.max(12, Math.min(window.scrollX + rect.left, window.scrollX + window.innerWidth - 440)) + 'px';
            editor.innerHTML = `
                <div style="font-size:0.78rem;color:var(--text-tertiary);margin-bottom:0.4rem;">Add note for selection</div>
                <textarea id="inlineSelectionNoteInput" placeholder="Write note... (Markdown supported)" style="width:100%;min-height:88px;background:var(--bg-primary);color:var(--text-primary);border:1px solid var(--border-color);border-radius:8px;padding:0.5rem;font-size:0.86rem;resize:vertical;"></textarea>
                <div style="display:flex;justify-content:flex-end;gap:0.45rem;margin-top:0.45rem;">
                    <button type="button" id="inlineSelectionNoteCancel" style="border:1px solid var(--border-color);background:var(--bg-elevated);color:var(--text-primary);border-radius:8px;padding:0.3rem 0.6rem;cursor:pointer;font-size:0.8rem;">Cancel</button>
                    <button type="button" id="inlineSelectionNoteSave" style="border:1px solid rgba(163,217,165,.55);background:var(--bg-elevated);color:var(--accent-secondary);border-radius:8px;padding:0.3rem 0.6rem;cursor:pointer;font-size:0.8rem;">Save</button>
                </div>
            `;
            document.body.appendChild(editor);
            const input = editor.querySelector('#inlineSelectionNoteInput');
            input?.focus();
            editor.querySelector('#inlineSelectionNoteCancel')?.addEventListener('click', closeInlineSelectionNoteEditor);
            editor.querySelector('#inlineSelectionNoteSave')?.addEventListener('click', () => {
                const body = (input?.value || '').trim() || '(highlighted)';
                addNote(selectionText, body, section);
                closeInlineSelectionNoteEditor();
            });
        }

        // ‚îÄ‚îÄ Init ‚îÄ‚îÄ
        document.addEventListener('DOMContentLoaded', () => {
            new LearningPageController();
            
            // Add reveal animation to concept sections
            document.querySelectorAll('.feynman-block, .quiz-container, .expandable, .chart-container, .diagram-container, .comparison-block, .stats-grid').forEach(el => {
                el.classList.add('reveal-on-scroll');
            });
            
            // Re-init observer for dynamically added elements
            const obs = new IntersectionObserver((entries) => {
                entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('revealed'); });
            }, { threshold: 0.08 });
            document.querySelectorAll('.reveal-on-scroll').forEach(el => obs.observe(el));
            
            // Initialize note draft autosave + live markdown preview
            initNoteComposer();
            // Load saved notes
            renderNotes();
        });
        
        // Typing dots animation
        const typingStyle = document.createElement('style');
        typingStyle.textContent = `
            .typing-dots span {
                animation: blink 1.4s infinite;
                font-size: 1.5em;
                line-height: 1;
            }
            .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
            .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
            @keyframes blink {
                0%, 60%, 100% { opacity: 0.2; }
                30% { opacity: 1; }
            }
        `;
        document.head.appendChild(typingStyle);
    
    </script>
    
    <!-- KaTeX auto-render -->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            if (typeof renderMathInElement !== 'undefined') {
                renderMathInElement(document.body, {
                    delimiters: [
                        {left: "$$", right: "$$", display: true},
                        {left: "$", right: "$", display: false},
                        {left: "\\(", right: "\\)", display: false},
                        {left: "\\[", right: "\\]", display: true}
                    ],
                    throwOnError: false
                });
            }
        });
    </script>
    <script src="./app-shell.js?v=12"></script>
    <script src="./lecture-enhancements.js?v=10"></script>
    <script>
(function(){
  function hardFallbackNav(){
    if (document.querySelector('.ios26-shell')) return;
    var nav=document.createElement('nav');
    nav.className='ios26-shell';
    nav.setAttribute('aria-label','Bottom navigation');
    var inner=document.createElement('div');
    inner.className='ios26-shell__inner';
    var items=[
      ['‚åÇ','Portal',function(){ location.href='./index.html'; }],
      ['‚ñ£','PDF',function(){ if (window.switchSidebarTab) window.switchSidebarTab('pdf'); }],
      ['‚úé','Notes',function(){ if (window.switchSidebarTab) window.switchSidebarTab('notes'); }],
      ['‚ú¶','AI',function(){ var ai=document.getElementById('aiInput'); if (ai) ai.focus(); }]
    ];
    items.forEach(function(it, idx){
      var btn=document.createElement('button');
      btn.type='button';
      btn.className='ios26-shell__btn'+(idx===0?' is-active':'');
      btn.innerHTML='<span class="ios26-shell__icon">'+it[0]+'</span><span class="ios26-shell__label">'+it[1]+'</span>';
      btn.addEventListener('click', function(){
        inner.querySelectorAll('.ios26-shell__btn').forEach(function(b){ b.classList.remove('is-active'); });
        btn.classList.add('is-active');
        it[2]();
      });
      inner.appendChild(btn);
    });
    nav.appendChild(inner);
    document.body.appendChild(nav);
  }
  window.addEventListener('load', function(){ setTimeout(hardFallbackNav, 800); });
})();
</script>
</body>
</html>